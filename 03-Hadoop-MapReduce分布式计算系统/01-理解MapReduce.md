## 一 简单理解MapReduce

MapReduce思想在生活中处处可见。或多或少都曾接触过这种思想。MapReduce的思想核心是“分而治之”，适用于大量复杂的任务处理场景（大规模数据处理场景）。即使是发布过论文实现分布式计算的谷歌也只是实现了这种思想，而不是自己原创。  

Map负责“分”，即把复杂的任务分解为若干个“简单的任务”来并行处理。可以进行拆分的前提是这些小任务可以并行计算，彼此间几乎没有依赖关系。  

Reduce负责“合”，即对map阶段的结果进行全局汇总。这两个阶段合起来正是MapReduce思想的体现。  


MapReduce思想模型:  
![](../images/bigdata/mapreduce-01.png)  

形象的来说：我们要数图书馆中的所有书。你数1号书架，我数2号书架。这就是“Map”。我们人越多，数书就更快。现在我们到一起，把所有人的统计数加在一起。这就是“Reduce”。  

MapReduce是一个分布式运算编程框架，核心功能是将用户编写的业务逻辑代码和自带组件整合成一个完整的分布式运算程序，并发运行在Hadoop集群上。  

MapReduce操作一个输入（input），通过本身定义好的计算模型，得到一个输出（output）。   

对许多开发者来说，自己完完全全实现一个并行计算程序难度太大，而MapReduce就是一种简化并行计算的编程模型，降低了开发并行应用的入门门槛。

## 二 MapReduce设计思路

#### 2.1  分而治之

对相互间不具有计算依赖关系的大数据，实现并行最自然的办法就是采取分而治之的策略。并行计算的第一个重要问题是如何划分计算任务或者计算数据以便对划分的子任务或数据块同时进行计算。不可分拆的计算任务或相互间有依赖关系的数据无法进行并行计算！  

#### 2.2 抽象模型Map和Reduce

MapReduce借鉴了函数式语言中的思想，用Map和Reduce两个函数提供了高层的并行编程抽象模型：
- Map(映射): 对一组数据元素进行某种重复式的处理，可以高度并行处理，对应代码中的抽象接口为map: `(k1; v1) → [(k2; v2)]`
- Reduce（化简）: 对Map的中间结果进行某种进一步的结果整理，即对一个列表的元素进行合并，对应代码中的抽象接口为：reduce：`(k2; [v2]) → [(k3; v3)]`

通过以上两个编程接口，可以看出MapReduce处理的数据类型是`<key,value>`键值对。一个简单的MapReduce程序只需要制定`map(),reduce(),input,output`即可，剩下的事情交给框架处理。  

#### 2.3 统一构架，隐藏系统层细节

Hadoop隐藏了大量的底层细节，开发者不再需要考虑诸如数据存储、划分、分发、结果收集、错误恢复等诸多细节；MapReduce为此设计并提供了统一接口。  

## 三 MapReduce框架结构

一个完整的mapreduce程序在分布式运行时有三类实例进程：
- MRAppMaster：负责整个程序的过程调度及状态协调
- MapTask：负责map阶段的整个数据处理流程
- ReduceTask：负责reduce阶段的整个数据处理流程

![](../images/bigdata/mapreduce-02.png)  


